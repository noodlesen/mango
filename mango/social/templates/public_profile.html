{% extends "base.html" %}

{% block title %}Профиль пользователя {{u.nickname}}{% endblock %}

{% block styles %}
{{ super() }}
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/ui.css') }}">
    <link rel=stylesheet type=text/css href="{{ url_for('social.static', filename='css/public_profile.css') }}">
{% endblock %}

{% block page_content %}
<div class="container">


    <div class="row" id ="profile__main">
<!--         <div class="col-lg-3">

        <section id="avatar">
              
        </section>


        </div> -->

        <div class="col-lg-8 col-lg-offset-2" style="text-align:center">
            <section id="userinfo">
              <div class="section-body">
              <img class="avatar-big" id="avatar__image" src="{{u.get_avatar()}}"/>
                <h1 id="nickname__title">{{u.nickname}}</h1>

                <div class="divider"></div>

                {% if current_user.id!= u.id %}
                <div id="user-actions__panel">

                  <button id="subscribe__btn" class="btn btn-large btn-default" v-if="!subscribed" @click="subscribe">
                    <i class="fa fa-plus"></i>
                    &nbsp;Подписаться
                  </button>

                  <button id="subscribe__btn" class="btn btn-large btn-default" v-if="subscribed" @click="unsubscribe">
                    <i class="fa fa-minus"></i>
                    &nbsp;Отписаться
                  </button>

                  <button id="private-message__show" class="btn btn-large btn-default" @click="showMessageForm">
                    <i class="glyphicon glyphicon-envelope" title="Выйти"></i>
                    &nbsp;Личное сообщение
                  </button>
                  <div id="private-message__form" v-show="showingMessageForm">
                    <div class="divider"></div>
                    <h4>Личное сообщение пользователю {{u.nickname}}</h4>
                    <textarea id="private-message__textarea" v-model="messageText"></textarea>
                    <button id="private-message__send-button" class="btn btn-large btn-default" @click="sendPrivateMessage">
                      Отправить
                    </button>
                  </div>

                  <div id="user-actions__status" class="alert alert-success" v-show="messageSuccess">
                    Ваше сообщение успешно отправлено!<br/>
                    Всю переписку вы можете посмотреть в вашем профиле, в разделе 
                    <a href="{{url_for('social.messenger')}}"> "Личные сообщения"</a>
                  </div>

                </div>
                {% endif %}
                </div>

            </section>
        </div>
      </div>





</div>

{% endblock %}

{% block scripts %}
    {{ super() }}
    <script type="text/javascript">
      var userId = {{u.id}};
      var canSendPm = "{{can_send_pm}}";
      var subscribed = "{{subscribed}}";
      var loggedIn = "{{logged_in}}"
    </script>
    <script src ="{{ url_for('static', filename="js/common.js") }}" type="text/javascript"></script>
    <script src ="{{ url_for('social.static', filename="js/public_profile.js") }}" type="text/javascript"></script>
{% endblock %}
